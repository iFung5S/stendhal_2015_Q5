<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GMHelpAction.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">stendhal</a> &gt; <a href="index.source.html" class="el_package">games.stendhal.client.actions</a> &gt; <span class="el_source">GMHelpAction.java</span></div><h1>GMHelpAction.java</h1><pre class="source lang-java linenums">/* $Id$ */
/***************************************************************************
 *                   (C) Copyright 2003-2010 - Stendhal                    *
 ***************************************************************************
 ***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
package games.stendhal.client.actions;

import games.stendhal.client.ClientSingletonRepository;
import games.stendhal.client.gui.chatlog.HeaderLessEventLine;
import games.stendhal.common.NotificationType;
import games.stendhal.common.messages.SupportMessageTemplatesFactory;

import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

/**
 * Display command usage. Eventually replace this with ChatCommand.usage().
 */
<span class="fc" id="L29">class GMHelpAction implements SlashAction {</span>

	/**
	 * Execute a chat command.
	 * 
	 * @param params
	 *            The formal parameters.
	 * @param remainder
	 *            Line content after parameters.
	 * 
	 * @return &lt;code&gt;true&lt;/code&gt; if was handled.
	 */
	@Override
	public boolean execute(final String[] params, final String remainder) {
	    List&lt;String&gt; lines;
<span class="nc bnc" id="L44" title="All 2 branches missed.">		if (params[0] == null) {</span>
<span class="nc" id="L45">			lines = Arrays.asList(</span>
				&quot;For a detailed reference, visit #http://stendhalgame.org/wiki/Stendhal:Administration&quot;,
				&quot;Here are the most-used GM commands:&quot;,
				&quot;- /gmhelp [alter|script|support]  \t for more info about alter, script or the supportanswer shortcuts&quot;, 
				&quot;- /supportanswer &lt;player&gt; &lt;message&gt; \t Replies to a support question. Replace &lt;message&gt; with $faq, $faqsocial, $ignore, $faqpvp, $wiki, $knownbug, $bugstracker, $rules, $notsupport or $spam shortcuts if desired.&quot;,
				&quot;- /adminnote &lt;player&gt; &lt;note&gt; \t\tLogs a note about this player&quot;,
				&quot;- /adminlevel &lt;player&gt; [&lt;newlevel&gt;] \t\tDisplay or set the adminlevel of the specified &lt;player&gt;&quot;,
				&quot;- /tellall &lt;message&gt; \t\tSend a private message to all logged-in players&quot;,
				&quot;- /jail &lt;player&gt; &lt;minutes&gt; &lt;reason&gt;\t\tImprisons the player for a given length of time&quot;,
				&quot;- /jailreport [&lt;player&gt;]\t\tList the jailed players and their sentences&quot;,
				&quot;- /gag &lt;player&gt; &lt;minutes&gt; &lt;reason&gt;\t\tGags the player for a given length of time (player is unable to send messages to anyone)&quot;,
				&quot;- /ban &lt;character&gt; &lt;hours&gt; &lt;reason&gt;\t\tBans the account of the character from logging onto the game server or website for the specified anmount of hours (-1 till end of time).&quot;,
				&quot;- /script &lt;scriptname&gt; \t\tLoad (or reload) a script on the server. See /gmhelp script for details&quot;,
				&quot;- /teleport &lt;player&gt; &lt;zone&gt; &lt;x&gt; &lt;y&gt; \tTeleport the specified &lt;player&gt; to the given location&quot;,
				&quot;- /teleportto &lt;player&gt; \t\tTeleport yourself near the specified player&quot;,
				&quot;- /teleclickmode \t\t\t Makes you teleport to the location you double click&quot;,
				&quot;- /ghostmode \t\t\t Makes yourself invisible and intangible&quot;,
				&quot;- /alter &lt;player&gt; &lt;attrib&gt; &lt;mode&gt; &lt;value&gt; \tAlter stat &lt;attrib&gt; of &lt;player&gt; by the given amount; &lt;mode&gt; can be ADD, SUB, SET or UNSET. See /gmhelp alter for details&quot;,
				&quot;- /altercreature &lt;id&gt; name;atk;def;hp;xp \tChange values of the creature. Use - as a placeholder to keep default value. Useful in raids&quot;,
				&quot;- /alterquest &lt;player&gt; &lt;questslot&gt; &lt;value&gt; \tUpdate the &lt;questslot&gt; for &lt;player&gt; to be &lt;value&gt;&quot;,
				&quot;- /summon &lt;creature|item&gt; [x] [y]\tSummon the specified item or creature at co-ordinates &lt;x&gt;, &lt;y&gt; in the current zone&quot;,
				&quot;- /summonat &lt;player&gt; &lt;slot&gt; [amount] &lt;item&gt; Summon the specified item into the specified slot of &lt;player&gt;; &lt;amount&gt; defaults to 1 if not specified&quot;,
				&quot;- /invisible \t\t\tToggles whether or not you are invisible to creatures&quot;,
				&quot;- /inspect &lt;player&gt; \t\t\tShow complete details of &lt;player&gt;&quot;,
				&quot;- /destroy &lt;entity&gt; \t\t\tDestroy an entity completely&quot;);
<span class="nc bnc" id="L70" title="All 4 branches missed.">		} else if ((params.length == 1) &amp;&amp; (params[0] != null)) {</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">			if (&quot;alter&quot;.equals(params[0])) {</span>
<span class="nc" id="L72">				lines = Arrays.asList(</span>
					&quot;/alter &lt;player&gt; &lt;attrib&gt; &lt;mode&gt; &lt;value&gt; \tAlter stat &lt;attrib&gt; of &lt;player&gt; by the given amount; &lt;mode&gt; can be ADD, SUB, SET or UNSET&quot;,
					&quot;Examples of &lt;attrib&gt;: atk, def, base_hp, hp, atk_xp, def_xp, xp, outfit&quot;,
					&quot;When modifying 'outfit', you should use SET mode and provide an 8-digit number; the first 2 digits are the 'hair' setting, then 'head', 'outfit', then 'body'&quot;,
					&quot;For example: #'/alter testplayer outfit set 12109901'&quot;,
					&quot;This will make &lt;testplayer&gt; look like danter&quot; );
<span class="nc bnc" id="L78" title="All 2 branches missed.">			} else if (&quot;script&quot;.equals(params[0])) {</span>
<span class="nc" id="L79">				lines = Arrays.asList(</span>
					&quot;usage: /script [-list|-load|-unload|-execute] [params]&quot;,
					&quot;-list : shows available scripts. In this mode can be given one optional parameter for filenames filtering, with using well-known wildcards for filenames ('*' and '?', for example \&quot;*.class\&quot; for java-only scripts).&quot;,
					&quot;-load : load script with first parameter's filename.&quot;,
					&quot;-unload : unload script with first parameter's filename from server&quot;,
					&quot;-execute : run choosed script.&quot;,
					&quot;&quot;,	
					&quot;All scripts are ran using: /script scriptname [params]. After running a script you can remove any traces of it with /script -unload scriptname, this would remove any summoned creatures, for example. It's good practise to do this after summoning creatures for a raid using scripts.&quot;,
					&quot;#/script #AdminMaker.class : For test servers only, summons an adminmaker to aid testing.&quot;,
					&quot;#/script #AdminSign.class #zone #x #y #text : Makes an AdminSign in zone at (x,y) with text. To put it next to you do /script AdminSign.class - - - text.&quot;,
					&quot;#/script #AlterQuest.class #player #questname #state : Update the quest for a player to be in a certain state. Omit #state to remove the quest.&quot;,
					&quot;#/script #DeepInspect.class #player : Deep inspects a player and all his/her items.&quot;,
					&quot;#/script #DropPlayerItems.class #player #[amount] #item : Drop the specified amount of items from the player if they are equipped in the bag or body.&quot;,
					&quot;#/script #EntitySearch.class #nonrespawn : Shows the locations of all creatures that don't respawn, for example creatures that were summoned by a GM, deathmatch creatures, etc.&quot;,
					&quot;#/script #FixDM.class #player : sets a player's DeathMatch slot to victory status.&quot;,
					&quot;#/script #ListNPCs.class : lists all npcs and their position.&quot;,
					&quot;#/script #LogoutPlayer.class #player : kicks a player from the game.&quot;,
					&quot;#/script #NPCShout.class #npc #text : NPC shouts text.&quot;,
					&quot;#/script #NPCShoutZone.class #npc #zone #text : NPC shouts text to players in given zone. Use - in place of zone to make it your current zone.&quot;,
					&quot;#/script #Plague.class #1 #creature : summon a plague of raid creatures around you.&quot;,
					&quot;#/script #WhereWho.class : Lists where all the online players are&quot;,
					&quot;#/script #Maria.class : Summons Maria, who sells food&amp;drinks. Don't forget to -unload her after you're done.&quot;,
					&quot;#/script #ServerReset.class : use only in a real emergency to shut down server. If possible please warn the players to logout and give them some time. It kills the server the hard way.&quot;,
					&quot;#/script #ResetSlot.class #player #slot : Resets the named slot such as !kills or !quests. Useful for debugging.&quot;
					);

<span class="nc bnc" id="L105" title="All 2 branches missed.">			} else if (&quot;support&quot;.equals(params[0])) {</span>
<span class="nc" id="L106">				lines = buildHelpSupportResponse();</span>
			} else {
<span class="nc" id="L108">				return false;</span>
			}
		} else {
<span class="nc" id="L111">			return false;</span>
		}
<span class="nc bnc" id="L113" title="All 2 branches missed.">		for (final String line : lines) {</span>
<span class="nc" id="L114">			ClientSingletonRepository.getUserInterface().addEventLine(new HeaderLessEventLine(line, NotificationType.CLIENT));</span>
<span class="nc" id="L115">		}</span>

<span class="nc" id="L117">		return true;</span>
	}

	private List&lt;String&gt; buildHelpSupportResponse() {
<span class="nc" id="L121">		List&lt;String&gt; lines = new LinkedList&lt;String&gt;();</span>
<span class="nc" id="L122">		Map&lt;String, String&gt; templates = new SupportMessageTemplatesFactory().getTemplates();</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">		for (Entry&lt;String, String&gt; template : templates.entrySet()) {</span>
<span class="nc" id="L124">			lines.add(template.getKey() + &quot; - &quot; + template.getValue());</span>
<span class="nc" id="L125">		}</span>
<span class="nc" id="L126">		return lines;</span>
	}

	/**
	 * Get the maximum number of formal parameters.
	 * 
	 * @return The parameter count.
	 */
	@Override
	public int getMaximumParameters() {
<span class="nc" id="L136">		return 1;</span>
	}

	/**
	 * Get the minimum number of formal parameters.
	 * 
	 * @return The parameter count.
	 */
	@Override
	public int getMinimumParameters() {
<span class="nc" id="L146">		return 0;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>