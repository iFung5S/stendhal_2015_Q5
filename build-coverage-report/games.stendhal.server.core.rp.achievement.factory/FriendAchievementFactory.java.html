<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>FriendAchievementFactory.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">stendhal</a> &gt; <a href="index.source.html" class="el_package">games.stendhal.server.core.rp.achievement.factory</a> &gt; <span class="el_source">FriendAchievementFactory.java</span></div><h1>FriendAchievementFactory.java</h1><pre class="source lang-java linenums">/***************************************************************************
 *                   (C) Copyright 2003-2011 - Stendhal                    *
 ***************************************************************************
 ***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
package games.stendhal.server.core.rp.achievement.factory;

import games.stendhal.common.parser.Sentence;
import games.stendhal.server.core.rp.achievement.Achievement;
import games.stendhal.server.core.rp.achievement.Category;
import games.stendhal.server.core.rp.achievement.condition.QuestWithPrefixCompletedCondition;
import games.stendhal.server.entity.Entity;
import games.stendhal.server.entity.npc.ChatCondition;
import games.stendhal.server.entity.npc.condition.AndCondition;
import games.stendhal.server.entity.npc.condition.QuestActiveCondition;
import games.stendhal.server.entity.npc.condition.QuestCompletedCondition;
import games.stendhal.server.entity.npc.condition.QuestNotInStateCondition;
import games.stendhal.server.entity.npc.condition.QuestStartedCondition;
import games.stendhal.server.entity.npc.condition.QuestStateStartsWithCondition;
import games.stendhal.server.entity.player.Player;

import java.util.Collection;
import java.util.LinkedList;
import java.util.List;
/**
 * Factory for quest achievements
 *
 * @author kymara
 */
<span class="nc" id="L36">public class FriendAchievementFactory extends AbstractAchievementFactory {</span>

	@Override
	public Collection&lt;Achievement&gt; createAchievements() {
<span class="nc" id="L40">		List&lt;Achievement&gt; achievements = new LinkedList&lt;Achievement&gt;();</span>

	    // TODO: add Pacifist achievement for not participating in pvp for 6 months or more (last_pvp_action_time)

		// Befriend Susi and complete quests for all children
<span class="nc" id="L45">		achievements.add(createAchievement(&quot;friend.quests.children&quot;, &quot;Childrens' friend&quot;, &quot;Complete quests for all children&quot;,</span>
				Achievement.MEDIUM_BASE_SCORE, true,
				new AndCondition(
						// Susi Quest is never set to done, therefore we check just if the quest has been started (condition &quot;anyFriends&quot; from FoundGirl.java)
						new QuestStartedCondition(&quot;susi&quot;),
						// Help Tad, Semos Town Hall (Medicine for Tad)
						new QuestCompletedCondition(&quot;introduce_players&quot;),
						// Plink, Semos Plains North
						new QuestCompletedCondition(&quot;plinks_toy&quot;),
						// Anna, in Ados
						new QuestCompletedCondition(&quot;toys_collector&quot;),
						// Sally, Orril River
						// 'completed' doesn't work for Sally - return player.hasQuest(QUEST_SLOT) &amp;&amp; !&quot;start&quot;.equals(player.getQuest(QUEST_SLOT)) &amp;&amp; !&quot;rejected&quot;.equals(player.getQuest(QUEST_SLOT));
						new AndCondition(new QuestActiveCondition(&quot;campfire&quot;), new QuestNotInStateCondition(&quot;campfire&quot;, &quot;start&quot;)),
						// Annie, Kalavan city gardens
						new QuestStateStartsWithCondition(&quot;icecream_for_annie&quot;,&quot;eating;&quot;),
						// Elisabeth, Kirdneh
						new QuestStateStartsWithCondition(&quot;chocolate_for_elisabeth&quot;,&quot;eating;&quot;),
						// Jef, Kirdneh
						new QuestCompletedCondition(&quot;find_jefs_mom&quot;),
						// Hughie, Ados farmhouse
						new AndCondition(new QuestActiveCondition(&quot;fishsoup_for_hughie&quot;), new QuestNotInStateCondition(&quot;fishsoup_for_hughie&quot;, &quot;start&quot;),
						// Finn Farmer, George
						new QuestCompletedCondition(&quot;coded_message&quot;)))));

		// quests about finding people
<span class="nc" id="L71">		achievements.add(createAchievement(&quot;friend.quests.find&quot;, &quot;Private Detective&quot;, &quot;Find all lost and hidden people&quot;,</span>
				Achievement.HARD_BASE_SCORE, true,
				new AndCondition(
						// Rat Children (Agnus)
						new QuestCompletedCondition(&quot;find_rat_kids&quot;),
						// Find Ghosts (Carena)
						new QuestCompletedCondition(&quot;find_ghosts&quot;),
						// Meet Angels (any of the cherubs)
<span class="nc" id="L79">						new ChatCondition() {</span>
							@Override
							public boolean fire(final Player player, final Sentence sentence, final Entity entity) {
<span class="nc bnc" id="L82" title="All 2 branches missed.">								if (!player.hasQuest(&quot;seven_cherubs&quot;)) {</span>
<span class="nc" id="L83">									return false;</span>
								}
<span class="nc" id="L85">								final String npcDoneText = player.getQuest(&quot;seven_cherubs&quot;);</span>
<span class="nc" id="L86">								final String[] done = npcDoneText.split(&quot;;&quot;);</span>
<span class="nc" id="L87">								final int left = 7 - done.length;</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">								return left &lt; 0;</span>
							}
						})));

		// earn over 250 karma
<span class="nc" id="L93">		achievements.add(createAchievement(&quot;friend.karma.250&quot;, &quot;Good Samaritan&quot;, &quot;Earn a very good karma&quot;,</span>
				Achievement.MEDIUM_BASE_SCORE, true,
<span class="nc" id="L95">				new ChatCondition() {</span>
			@Override
			public boolean fire(final Player player, final Sentence sentence, final Entity entity) {
<span class="nc bnc" id="L98" title="All 2 branches missed.">				return player.getKarma()&gt;250;</span>
			}
		}));

		// meet Santa Claus and Easter Bunny
<span class="nc" id="L103">		achievements.add(createAchievement(&quot;friend.meet.seasonal&quot;, &quot;Still Believing&quot;, &quot;Meet Santa Claus and Easter Bunny&quot;,</span>
												Achievement.EASY_BASE_SCORE, true, new AndCondition(new QuestWithPrefixCompletedCondition(&quot;meet_santa_&quot;), new QuestWithPrefixCompletedCondition(&quot;meet_bunny_&quot;))));

<span class="nc" id="L106">		return achievements;</span>
	}

	@Override
	protected Category getCategory() {
<span class="nc" id="L111">		return Category.FRIEND;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>