<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>JailedDwarf.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">stendhal</a> &gt; <a href="index.source.html" class="el_package">games.stendhal.server.maps.quests</a> &gt; <span class="el_source">JailedDwarf.java</span></div><h1>JailedDwarf.java</h1><pre class="source lang-java linenums">/* $Id$ */
/***************************************************************************
 *                   (C) Copyright 2003-2010 - Stendhal                    *
 ***************************************************************************
 ***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
package games.stendhal.server.maps.quests;

import games.stendhal.server.entity.npc.ConversationPhrases;
import games.stendhal.server.entity.npc.ConversationStates;
import games.stendhal.server.entity.npc.SpeakerNPC;
import games.stendhal.server.entity.npc.action.IncreaseKarmaAction;
import games.stendhal.server.entity.npc.action.IncreaseXPAction;
import games.stendhal.server.entity.npc.action.MultipleActions;
import games.stendhal.server.entity.npc.action.SetQuestAction;
import games.stendhal.server.entity.npc.condition.AndCondition;
import games.stendhal.server.entity.npc.condition.GreetingMatchesNameCondition;
import games.stendhal.server.entity.npc.condition.NotCondition;
import games.stendhal.server.entity.npc.condition.PlayerHasItemWithHimCondition;
import games.stendhal.server.entity.npc.condition.QuestCompletedCondition;
import games.stendhal.server.entity.npc.condition.QuestNotCompletedCondition;
import games.stendhal.server.entity.player.Player;
import games.stendhal.server.maps.Region;

import java.util.ArrayList;
import java.util.List;

/**
 * QUEST: Jailed Dwarf
 * 
 * PARTICIPANTS: - Hunel, the guard of the Dwarf Kingdom's Prison
 * 
 * STEPS:
 * &lt;ul&gt;
 * &lt;li&gt; You see Hunel locked in the cell. &lt;/li&gt;
 * &lt;li&gt; Gget the key by killing the duergar king. &lt;/li&gt;
 * &lt;li&gt; Speak to Hunel when you have the key. &lt;/li&gt;
 * &lt;li&gt; Hunel wants to stay in, he is afraid. &lt;/li&gt;
 * &lt;li&gt; You can then sell chaos equipment to Hunel. &lt;/li&gt;
 * &lt;/ul&gt;
 * 
 * REWARD:
 * &lt;ul&gt;
 * &lt;li&gt; 2,000 XP &lt;/li&gt;
 * &lt;li&gt; some karma (20) &lt;/li&gt;
 * &lt;li&gt; everlasting place to sell chaos equipment &lt;/li&gt;
 * &lt;/ul&gt;
 * 
 * REPETITIONS: - None.
 */
<span class="fc" id="L57">public class JailedDwarf extends AbstractQuest {</span>

	private static final String QUEST_SLOT = &quot;jailed_dwarf&quot;;



	@Override
	public String getSlotName() {
<span class="nc" id="L65">		return QUEST_SLOT;</span>
	}

	private void step_1() {
<span class="fc" id="L69">		final SpeakerNPC npc = npcs.get(&quot;Hunel&quot;);</span>

<span class="fc" id="L71">		npc.add(ConversationStates.IDLE, ConversationPhrases.GREETING_MESSAGES,</span>
				new AndCondition(new GreetingMatchesNameCondition(npc.getName()),
						new QuestCompletedCondition(QUEST_SLOT)),
				ConversationStates.ATTENDING,
				&quot;Hi. As you see, I am still too nervous to leave ...&quot;,
				null);

<span class="fc" id="L78">		npc.add(ConversationStates.IDLE, ConversationPhrases.GREETING_MESSAGES,</span>
				new AndCondition(new GreetingMatchesNameCondition(npc.getName()),
						new QuestNotCompletedCondition(QUEST_SLOT),
						new NotCondition(new PlayerHasItemWithHimCondition(&quot;kanmararn prison key&quot;))),
				ConversationStates.IDLE,
				&quot;Help! The duergars have raided the prison and locked me up! I'm supposed to be the Guard! It's a shambles.&quot;,
				new SetQuestAction(QUEST_SLOT, &quot;start&quot;));

<span class="fc" id="L86">		npc.add(ConversationStates.IDLE, ConversationPhrases.GREETING_MESSAGES,</span>
				new AndCondition(new GreetingMatchesNameCondition(npc.getName()),
						new QuestNotCompletedCondition(QUEST_SLOT),
						new PlayerHasItemWithHimCondition(&quot;kanmararn prison key&quot;)),
				ConversationStates.ATTENDING,
				&quot;You got the key to unlock me! *mumble*  Errrr ... it doesn't look too safe out there for me ... I think I'll just stay here ... perhaps someone could #offer me some good equipment ... &quot;,
				new MultipleActions(new SetQuestAction(QUEST_SLOT, &quot;done&quot;),
						 			 new IncreaseXPAction(2000),
						 			 new IncreaseKarmaAction(20)));
<span class="fc" id="L95">	}</span>

	@Override
	public void addToWorld() {
<span class="fc" id="L99">		fillQuestInfo(</span>
				&quot;Jailed Dwarf&quot;,
				&quot;Down in Kanmararn is an afraid dwarf locked in a cell waiting for visitors. He is supposed to be the guard, but duergars have raided the prison. He might need some armor to survive once out of it.&quot;,
				true);
<span class="fc" id="L103">		step_1();</span>
<span class="fc" id="L104">	}</span>
	
	@Override
	public List&lt;String&gt; getHistory(final Player player) {
<span class="nc" id="L108">			final List&lt;String&gt; res = new ArrayList&lt;String&gt;();</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">			if (!player.hasQuest(QUEST_SLOT)) {</span>
<span class="nc" id="L110">				return res;</span>
			}
<span class="nc" id="L112">			res.add(&quot;I need to get a key to unlock Hunel.&quot;);</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">			if (isCompleted(player)) {</span>
<span class="nc" id="L114">				res.add(&quot;I killed the Duergar King and got the key to unlock Hunel. But now he's too afraid to leave, wanting to buy more and more armor before he feels safe. Poor Hunel.&quot;);</span>
			}
<span class="nc" id="L116">			return res;</span>
	}
	
	@Override
	public String getName() {
<span class="nc" id="L121">		return &quot;JailedDwarf&quot;;</span>
	}
	
	@Override
	public int getMinLevel() {
<span class="fc" id="L126">		return 60;</span>
	}

	@Override
	public String getNPCName() {
<span class="nc" id="L131">		return &quot;Hunel&quot;;</span>
	}
	
	@Override
	public String getRegion() {
<span class="nc" id="L136">		return Region.SEMOS_DUNGEONS;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>