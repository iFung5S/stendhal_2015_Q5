<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GeneralSettings.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">stendhal</a> &gt; <a href="index.source.html" class="el_package">games.stendhal.client.gui.settings</a> &gt; <span class="el_source">GeneralSettings.java</span></div><h1>GeneralSettings.java</h1><pre class="source lang-java linenums">/***************************************************************************
 *                   (C) Copyright 2003-2010 - Stendhal                    *
 ***************************************************************************
 ***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
package games.stendhal.client.gui.settings;

import games.stendhal.client.gui.j2DClient;
import games.stendhal.client.gui.layout.SBoxLayout;
import games.stendhal.client.gui.layout.SLayout;
import games.stendhal.client.gui.styled.Style;
import games.stendhal.client.gui.styled.StyleUtil;

import java.awt.Frame;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.border.TitledBorder;

/**
 * Page for general settings.
 */
class GeneralSettings {
	private static final String GAMESCREEN_AUTORAISECORPSE = &quot;gamescreen.autoraisecorpse&quot;;
	
	/** Property used for the double click setting. */
	private static final String DOUBLE_CLICK_PROPERTY = &quot;ui.doubleclick&quot;;
	
	private static final String HEALING_MESSAGE_PROPERTY = &quot;ui.healingmessage&quot;;
	
	private static final String POISON_MESSAGE_PROPERTY = &quot;ui.poisonmessage&quot;;
	
	private static final String DIMENSIONS_PROPERTY = &quot;ui.dimensions&quot;;
	
	/** Container for the setting components. */
	private final JComponent page;
	
	/**
	 * Create new GeneralSettings.
	 */
<span class="nc" id="L52">	GeneralSettings() {</span>
<span class="nc" id="L53">		int pad = SBoxLayout.COMMON_PADDING;</span>
<span class="nc" id="L54">		page = SBoxLayout.createContainer(SBoxLayout.VERTICAL, pad);</span>
		
<span class="nc" id="L56">		page.setBorder(BorderFactory.createEmptyBorder(pad, pad, pad, pad));</span>
		
		// click mode
<span class="nc" id="L59">		JCheckBox clickModeToggle = SettingsComponentFactory.createSettingsToggle(DOUBLE_CLICK_PROPERTY, &quot;false&quot;,</span>
				&quot;Double Click Mode&quot;, &quot;Move and attack with double click. If not checked, a single click is enough.&quot;);
<span class="nc" id="L61">		page.add(clickModeToggle);</span>
		
		// raising corpses
<span class="nc" id="L64">		JCheckBox autoRaiseToggle = SettingsComponentFactory.createSettingsToggle(GAMESCREEN_AUTORAISECORPSE, &quot;true&quot;,</span>
				&quot;Auto inspect corpses&quot;, &quot;Automatically open the loot window for corpses of creatures you can loot&quot;);
<span class="nc" id="L66">		page.add(autoRaiseToggle);</span>
		
		// show healing messages
<span class="nc" id="L69">		JCheckBox showHealingToggle = SettingsComponentFactory.createSettingsToggle(HEALING_MESSAGE_PROPERTY, &quot;false&quot;,</span>
				&quot;Show healing messages&quot;, &quot;Show healing messages in the chat log&quot;);
<span class="nc" id="L71">		page.add(showHealingToggle);</span>
		
		// show poison messages
<span class="nc" id="L74">		JCheckBox showPoisonToggle = SettingsComponentFactory.createSettingsToggle(POISON_MESSAGE_PROPERTY, &quot;false&quot;,</span>
										&quot;Show poison messages&quot;, &quot;Show poisoned messages in the chat log&quot;);
<span class="nc" id="L76">		page.add(showPoisonToggle);</span>
		
		// Client dimensions
<span class="nc" id="L79">		JComponent clientSizeBox = SBoxLayout.createContainer(SBoxLayout.VERTICAL, pad);</span>
<span class="nc" id="L80">		TitledBorder titleB = BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(),</span>
				&quot;Client Dimensions&quot;);
		// There seems to be no good way to change the default background color
		// of all components. The color is needed for making the etched border.
<span class="nc" id="L84">		Style style = StyleUtil.getStyle();</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">		if (style != null) {</span>
<span class="nc" id="L86">			clientSizeBox.setBackground(style.getPlainColor());</span>
<span class="nc" id="L87">			titleB.setTitleColor(style.getForeground());</span>
		}
<span class="nc" id="L89">		clientSizeBox.setBorder(BorderFactory.createCompoundBorder(titleB,</span>
				BorderFactory.createEmptyBorder(pad, pad, pad, pad)));
		
		// Save client dimensions
<span class="nc" id="L93">		JCheckBox saveDimensionsToggle =</span>
				SettingsComponentFactory.createSettingsToggle(
						DIMENSIONS_PROPERTY, &quot;true&quot;, &quot;Save size&quot;,
						&quot;Restores the client's width, height, and maximized state in future sessions&quot;);
<span class="nc" id="L97">		clientSizeBox.add(saveDimensionsToggle);</span>
		
		// Reset client window to default dimensions
<span class="nc" id="L100">		JButton resetDimensions = new JButton(&quot;Reset&quot;);</span>
<span class="nc" id="L101">		resetDimensions.setToolTipText(</span>
				&quot;Resets the client's width and height to their default dimensions&quot;);
<span class="nc" id="L103">		resetDimensions.setActionCommand(&quot;reset_dimensions&quot;);</span>
<span class="nc" id="L104">		resetDimensions.addActionListener(new ActionListener() {</span>
			@Override
			public void actionPerformed(ActionEvent arg0) {
<span class="nc" id="L107">				resetClientDimensions();</span>
<span class="nc" id="L108">			}</span>
		});
<span class="nc" id="L110">		resetDimensions.setAlignmentX(JComponent.RIGHT_ALIGNMENT);</span>
<span class="nc" id="L111">		clientSizeBox.add(resetDimensions);</span>
		
<span class="nc" id="L113">		page.add(clientSizeBox, SLayout.EXPAND_X);</span>
<span class="nc" id="L114">	}</span>
		
	/**
	 * Get the component containing the general settings.
	 * 
	 * @return general settings page
	 */
	JComponent getComponent() {
<span class="nc" id="L122">		return page;</span>
	}
	
	/**
	 * Resets the clients width and height to their default values.
	 */
	private void resetClientDimensions() {
<span class="nc" id="L129">		j2DClient clientFrame = j2DClient.get();</span>
<span class="nc" id="L130">		Frame mainFrame = clientFrame.getMainFrame();</span>
<span class="nc" id="L131">		int frameState = mainFrame.getExtendedState();</span>
		
		/*
		 *  Do not attempt to reset client dimensions if window is maximized.
		 *  Prevents resizing errors for child components.
		 */
<span class="nc bnc" id="L137" title="All 2 branches missed.">		if (frameState != JFrame.MAXIMIZED_BOTH) {</span>
<span class="nc" id="L138">			mainFrame.setSize(clientFrame.getFrameDefaultSize());</span>
		}
<span class="nc" id="L140">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>